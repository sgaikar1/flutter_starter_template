#!/bin/bash

# Pre-commit hook for Flutter projects
# Runs formatting, analysis, and tests before allowing commit

set -e

echo "ğŸ” Running pre-commit checks..."

# Format check
echo "ğŸ“ Checking code formatting..."
if ! dart format --set-exit-if-changed lib/ test/; then
    echo "âŒ Code formatting issues found."
    echo "Run 'dart format lib/ test/' to fix."
    exit 1
fi
echo "âœ“ Code formatting passed"

# Analyze
echo "ğŸ”¬ Running static analysis..."
if ! flutter analyze; then
    echo "âŒ Analysis found issues."
    echo "Fix the issues above before committing."
    exit 1
fi
echo "âœ“ Static analysis passed"

# Optionally run tests (commented out by default as it can be slow)
# Uncomment if you want tests to run on every commit
# echo "ğŸ§ª Running tests..."
# if ! flutter test; then
#     echo "âŒ Tests failed."
#     echo "Fix failing tests before committing."
#     exit 1
# fi
# echo "âœ“ Tests passed"

echo "âœ… All pre-commit checks passed!"
